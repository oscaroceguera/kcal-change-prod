(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{54:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(70)),l=u(a(112)),o=u(a(5517)),r=u(a(41)),s=u(a(42)),i=u(a(5518));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,r.default)(this,e),this.domain=t||"http://localhost:5000/api",this.fetch=this.fetch.bind(this),this.login=this.login.bind(this),this.getProfile=this.getProfile.bind(this)}return(0,s.default)(e,[{key:"login",value:function(e,t){var a=this;return this.fetch(this.domain+"/users/login",{method:"POST",body:(0,o.default)({email:e,password:t})}).then(function(e){return console.log("res ==>",e),a.setToken(e.token),l.default.resolve(e)})}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return(0,i.default)(e).exp<Date.now()/1e3}catch(e){return!1}}},{key:"setToken",value:function(e){localStorage.setItem("id_token",e)}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"logout",value:function(){localStorage.removeItem("id_token")}},{key:"getProfile",value:function(){return(0,i.default)(this.getToken())}},{key:"fetch",value:function(e){function t(t,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var a={Accept:"application/json","Content-Type":"application/json"};return this.loggedIn()&&(a.Authorization="Bearer "+this.getToken()),fetch(e,(0,n.default)({headers:a},t)).then(this._checkStatus).then(function(e){return e.json()})})},{key:"_checkStatus",value:function(e){if(200<=e.status&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}}]),e}();t.default=c},5824:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=S(a(112)),l=S(a(5825)),o=S(a(103)),r=S(a(104)),s=S(a(5832)),i=S(a(167)),u=S(a(55)),c=S(a(41)),d=S(a(42)),h=S(a(56)),f=S(a(57)),p=S(a(54)),m=S(a(85)),g=S(a(1)),v=a(19),y=S(a(106)),C=a(5910),k=a(43),A=S(a(44)),_=S(a(137)),x=a(71),w=S(a(5837)),E=a(246);function S(e){return e&&e.__esModule?e:{default:e}}var b=new p.default,T=function(e,t){return e.find(function(e){return e.label===t}).uuid},I={headers:{"x-auth":localStorage.getItem("id_token")}},B={meal:"",inputValue:"",selectedItem:[],selectedFood:[],mealType:"",date:(0,_.default)(new Date,"YYYY-MM-dd"),loading:!1,error:null,foodCatalog:[],mealCatalog:[]},D=function(e){function t(){var e,a,n,l,d,f,p,m=this;(0,c.default)(this,t);for(var g=arguments.length,v=Array(g),C=0;C<g;C++)v[C]=arguments[C];return(a=n=(0,h.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(v)))).state=B,n.onChange=function(e){n.setState((0,i.default)({},e.target.name,e.target.value))},n.handleKeyDown=function(e){var t=n.state,a=t.inputValue,l=t.selectedItem;l.length&&!a.length&&"backspace"===(0,A.default)(e)&&n.setState({selectedItem:l.slice(0,l.length-1)})},n.handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.handleChange=function(e){var t=n.state,a=t.selectedItem,l=t.selectedFood;-1===a.indexOf(e)&&(a=[].concat((0,s.default)(a),[e]),l=[].concat((0,s.default)(l),[T(n.state.foodCatalog,e)])),n.setState({inputValue:"",selectedItem:a,selectedFood:l})},n.handleDelete=function(e){return function(){n.setState(function(t){var a=[].concat((0,s.default)(t.selectedItem)),l=[].concat((0,s.default)(t.selectedFood));return a.splice(a.indexOf(e),1),l.splice(l.indexOf(T(n.state.foodCatalog,e)),1),{selectedItem:a,selectedFood:l}})}},n.onUpdate=(p=(0,r.default)(o.default.mark(function e(t){var a,l,r,s,i,u,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),a=n.state,l=a.meal,r=a.selectedFood,s=a.mealType,i=a.date,u={meal:l,foods:r,mealType:s,date:i},c=n.props.match.params.uuid,e.prev=4,e.next=7,y.default.patch("http://localhost:5000/api/meals/"+c,u,I);case 7:e.sent,n.setState({loading:!1}),n.props.history.push("/dashboard"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),n.setState({error:e.t0.message,loading:!1});case 15:case"end":return e.stop()}},e,m,[[4,12]])})),function(e){return p.apply(this,arguments)}),n.onSave=(f=(0,r.default)(o.default.mark(function e(t){var a,l,r,s,i,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),a=n.state,l=a.meal,r=a.selectedFood,s=a.mealType,i=a.date,u={meal:l,foods:r,mealType:s,date:i},e.prev=3,e.next=6,y.default.post("http://localhost:5000/api/meals",u,I);case 6:e.sent,n.setState({loading:!1}),n.props.history.push("/dashboard"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),n.setState({error:e.t0.message,loading:!1});case 14:case"end":return e.stop()}},e,m,[[3,11]])})),function(e){return f.apply(this,arguments)}),n.onDelete=(d=(0,r.default)(o.default.mark(function e(t){var a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),a=n.props.match.params.uuid,e.prev=2,e.next=5,y.default.delete("http://localhost:5000/api/meals/"+a,I);case 5:e.sent,n.setState({loading:!1}),n.props.history.push("/"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),n.setState({error:e.t0.message,loading:!1});case 13:case"end":return e.stop()}},e,m,[[2,10]])})),function(e){return d.apply(this,arguments)}),n.logout=function(e){b.logout(),n.props.history.replace("/login")},l=a,(0,h.default)(n,l)}var a,p;return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.uuid;e&&this.getDetail(e),this.load()}},{key:"load",value:(p=(0,r.default)(o.default.mark(function e(){var t,a,r,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.prev=1,e.next=4,n.default.all([y.default.get("http://localhost:5000/api/catalogs/foodTypes",I).then(function(e){return e.data}),y.default.get("http://localhost:5000/api/catalogs/mealTypes",I).then(function(e){return e.data})]);case 4:t=e.sent,a=(0,l.default)(t,2),r=a[0],s=a[1],this.setState({loading:!1,foodCatalog:r,mealCatalog:s}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({error:e.t0.message,loading:!1});case 14:case"end":return e.stop()}},e,this,[[1,11]])})),function(){return p.apply(this,arguments)})},{key:"getDetail",value:(a=(0,r.default)(o.default.mark(function e(t){var a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.prev=1,e.next=4,y.default.get("http://localhost:5000/api/meals/"+t,I).then(function(e){return e.data});case 4:a=e.sent,this.setState({loading:!1,meal:a.meal,mealType:a.mealType.uuid,date:(0,E.UTCDate)(a.date,"YYYY-MM-dd"),selectedItem:a.foods.map(function(e){return e.label}),selectedFood:a.foods.map(function(e){return e.uuid})}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.setState({error:e.t0.message,loading:!1});case 11:case"end":return e.stop()}},e,this,[[1,8]])})),function(e){return a.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.setState(B)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.meal,n=t.mealType,l=t.selectedItem,o=t.inputValue,r=(t.selectedFood,t.loading),s=t.error,i=t.date,u=t.foodCatalog,c=t.mealCatalog,d=!!a&&!!n&&0<l.length,h=i||(0,_.default)(new Date,"YYYY-MM-dd");return r?g.default.createElement("div",{style:{textAlign:"center",marginTop:"5em"}},g.default.createElement(x.Circular,null)):s?g.default.createElement("p",null,s):g.default.createElement("div",null,g.default.createElement(x.NavMenu,{username:this.props.user.username,logout:this.logout}),g.default.createElement("h1",{className:w.default.title},"Agregar CalorÃ­as"),g.default.createElement(k.Paper,{elevation:1,className:e.root},g.default.createElement(k.TextField,{error:!this.state.meal,name:"meal",label:"Comida",value:this.state.meal,onChange:this.onChange,margin:"normal",style:{width:"50%"}}),g.default.createElement(x.SimpleSelect,{data:c,label:"Tipo",name:"mealType",value:this.state.mealType,onChange:this.onChange}),g.default.createElement(k.TextField,{id:"date",label:"Fecha",type:"date",name:"date",defaultValue:h,onChange:this.onChange,InputLabelProps:{shrink:!0}}),g.default.createElement(x.Autocomplete,{label:"Alimentos",placeholder:"Seleccione multiples alimentos",data:u,inputValue:o,selectedItem:l,handleKeyDown:this.handleKeyDown,handleInputChange:this.handleInputChange,handleChange:this.handleChange,handleDelete:this.handleDelete}),g.default.createElement("div",{className:w.default.btnContainer},this.props.match.params.uuid&&g.default.createElement(k.Button,{className:e.deleteBtn,name:"mealType",variant:"contained",onClick:this.onDelete},"Eliminar"),g.default.createElement(k.Button,{disabled:!d,name:"mealType",variant:"contained",color:"secondary",onClick:this.props.match.params.uuid?this.onUpdate:this.onSave},this.props.match.params.uuid?"Actualizar":"Guardar"))))}}]),t}(g.default.Component);t.default=(0,C.compose)((0,v.withStyles)(function(e){return{root:{padding:"1em",width:"50%",margin:"0 auto"},avatar:{padding:".5em",width:"100px",height:"100px",background:"#651fff"},deleteBtn:{marginRight:"2em",background:"#f44336",color:"white"}}}),m.default)(D)},5837:function(e,t,a){var n=a(5838);"string"==typeof n&&(n=[[e.i,n,""]]);a(59)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},5838:function(e,t,a){(t=e.exports=a(58)(!0)).push([e.i,".styles_title_Cg225NhCQWu0KPjk5hkVy {\n  text-align: center;\n  color: #f44336;\n}\n\n.styles_btnContainer_1eKPDxqs7ePkWFRKQwXqXF {\n  text-align: right;\n  margin-top: .5em;\n}\n\n.styles_section_1mp7qdNumzvPJCK1jHtwE8 {\n  margin-top: .5em;\n}\n\n.styles_avatarContainer_2tcZ4tbW-tszOuzgehAh31 {\n  padding: 1em;\n  display: flex;\n  justify-content: center;\n}","",{version:3,sources:["/Users/oscaroceguera/Documents/Repos/Examples/calorie_challenge/front/src/container/Calories/styles.css"],names:[],mappings:"AAAA;EACE,mBAAmB;EACnB,eAAe;CAChB;;AAED;EACE,kBAAkB;EAClB,iBAAiB;CAClB;;AAED;EACE,iBAAiB;CAClB;;AAED;EACE,aAAa;EACb,cAAc;EACd,wBAAwB;CACzB",file:"styles.css",sourcesContent:[".title {\n  text-align: center;\n  color: #f44336;\n}\n\n.btnContainer {\n  text-align: right;\n  margin-top: .5em;\n}\n\n.section {\n  margin-top: .5em;\n}\n\n.avatarContainer {\n  padding: 1em;\n  display: flex;\n  justify-content: center;\n}"],sourceRoot:""}]),t.locals={title:"styles_title_Cg225NhCQWu0KPjk5hkVy",btnContainer:"styles_btnContainer_1eKPDxqs7ePkWFRKQwXqXF",section:"styles_section_1mp7qdNumzvPJCK1jHtwE8",avatarContainer:"styles_avatarContainer_2tcZ4tbW-tszOuzgehAh31"}},85:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(70)),l=d(a(55)),o=d(a(41)),r=d(a(42)),s=d(a(56)),i=d(a(57));t.default=function(e){var t=new c.default("http://localhost:5000/api");return function(a){function c(e){(0,o.default)(this,c);var t=(0,s.default)(this,(c.__proto__||(0,l.default)(c)).call(this,e));return t.state={user:null},t}return(0,i.default)(c,a),(0,r.default)(c,[{key:"componentWillMount",value:function(){if(t.loggedIn())try{var e=t.getProfile();console.log("profile",e),this.setState({user:e})}catch(e){t.logout(),this.props.history.replace("/login")}else this.props.history.replace("/login")}},{key:"render",value:function(){return this.state.user?u.default.createElement(e,(0,n.default)({history:this.props.history,user:this.state.user},this.props)):null}}]),c}(u.default.Component)};var u=d(a(1)),c=d(a(54));function d(e){return e&&e.__esModule?e:{default:e}}}}]);
//# sourceMappingURL=4.bundle.js.map